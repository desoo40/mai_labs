Как часто выигрывает лучшая команда?
Единый подход к понимаю случайности в североамериканском спорте

By Michael J. Lopez
Skidmore College and
By Gregory J. Matthews Loyola University Chicago and
By Benjamin S. Baumer Smith College

Статистические приложения в спорте давно сосредоточены на том, как лучше отделить сигнал (например, талант команды) от случайного шума. Тем не менее, большая часть этих работ сконцентрирована на одном виде спорта, и развитие значимых межспортивных сравнений было затруднено из-за сложности перевода удачи из одного вида спорта в другой. В этой работе мы разрабатываем байесовские модели пространства состояний с использованием рыночных данных о ставках, которые могут быть единообразно применены в спортивных организациях для лучшего понимания роли случайности в результатах игры. Эти модели можно использовать для получения оценок силы команды, изменяющейся между сезонами, в течение сезона и от игры к игре, а также домашнее преимущество каждой команды. Мы реализуем наш подход в течение десятилетия игры в каждой лиг: Национальной футбольной лиги (НФЛ), Национальной хоккейной лиги (НХЛ), Национальной баскетбольной ассоциации (НБА) и Высшей лиги бейсбола (МЛБ), обнаруживая, что НБА демонстрирует и  наибольшую дисперсую в таланте и наибольшее домашнее преимущество, в то время как НХЛ и MLB выделяются своей относительной случайностью в результатах игры. В заключение мы предлагаем новые показатели для оценки конкурентоспособности в спортивных лигах как в рамках регулярного сезона, так и с использованием традиционных форматов турниров после сезона. Хотя мы сосредоточены на спорте, мы обсуждаем ряд других ситуаций, в которых наши обобщаемые модели могут быть с пользой применены.

1. Введение.

Большинство зрителей спорта могут согласиться с тем, что результаты игры в некоторой степени зависят от случая. Line drive, который чудесным образом находит перчатку полевого игрока, мяч, который безобидно отскакивает за пределы поля, шайба, которая рикошетит в ворота соперника, или свисток судьи на чистом блоке - все это может означать разницу между победой и поражением. Тем не менее, результаты игры не являются абсолютно случайными - есть команды, которые постоянно играют лучше или хуже, чем средняя команда. В какой степени удача влияет на наше восприятие силы команды с течением времени? 

Один из путей, которым статистика может привести к этому обсуждению, лежит в распознавании сигнала и шума при сравнении "калибра" команд в каждой лиге. Например, лучше ли команд i команды j? И если да, то насколько уверены, делая такое заявление? Основным в таком видении понимании спортивных результатов является то, что если мы знаем относительную силу каждой команды, то априаорные результаты матча - включая победы и поражения - можно представить как ненаблюдаемые реализации случайных величин. В качестве простого примера, если вероятность того, что команда i победит команду j в момент времени k, составляет 0,75, это означает, что в гипотетическом бесконечном количестве игр между двумя командами в момент времени k i выигрывает в три раза чаще, чем j. К сожалению, на практике команда i обычно играет с командой j один раз в момент времени k. Таким образом, одни лишь результаты игры вряд ли предоставят достаточно информации для точной оценки истинных вероятностей и, в свою очередь, сильных сторон команды.

Учитывая как общенациональный общественный интерес, так и академическое любопытство, которое распространилось по дисциплинам, было разработано много инновационных методов для оценки силы команды. Эти подходы обычно объединяют прошлые результаты игр с  характеристиками игры, команды и игрока в статистическую модели. Соответствующие оценки таланта часто проверяются или калибруются путем сравнения вневыборочных оценок вероятностей выигрышей и проигрышей с наблюдаемыми результатами. Такие упражнения несут больше пользы, чем просто "кухонные разговоры" о том, какая команда лучше. Действительно, оценка командного рейтинга способствовала развитию продвинутых статистических моделей (Брэдли и Терри, 1952; Гликман и Стерн, 1998) и иногда играла роль в принятии решения о том, какие команды имеют право на продолжение игры после сезона (игры в плей-офф) (CFP, 2014).

Однако, поскольку случайность проявляется по-разному в разных видах спорта, ограничение моделей, характерных для спорта, состоит в том, что выводы, как правило, не могут глобально применяться к другим соревнованиям. В результате исследователи, которые надеются противопоставить одну лигу другой, часто сосредотачиваются на одном общем результате для всех видов спорта: соотношении выигрыша и проигрыша. Среди других факторов, измерение силы команды с использованием выигрышей и проигрышей плохо работает при небольшом размере выборки, игнорируя итоговый счет игры (который, как известно, лучше прогнозирует будущие противостояния, чем коэффициент выигрыша / проигрыша (Boulier and Stekler, 2003)), и излишне подвержен влиянию, среди прочих источников, колебаниям в расписании лиги, травмам ключевых игроков и общему преимуществу домашних игр. В частности, различия в продолжительности сезона между видами спорта - команды НФЛ играют 16 игр в регулярном сезоне каждый год, команды НХЛ и НБА - 82, а команды MLB - 162 - могут сделать недействительными прямые сравнения только процентных показателей побед. Например, самый высокий годовой процент командных побед составляет около 87% в НФЛ, но только 61% в MLB, и часть (но не вся) этого различия, несомненно, связана с более коротким регулярным сезоном НФЛ. В результате, до сих пор аналитики и болельщики так и не смогли количественно оценить присущие различия между видами спорта или спортивными лигами в отношении случайности, разброса и развития силы команды. Мы стремимся заполнить эту пустоту.

В следующих разделах мы представляем унифицированную и новую основу для одновременного сравнения спортивных лиг, которую мы реализуем для выявления неотъемлемых отличий в североамериканском спорте. Во-первых, мы подтверждаем предположение о том, что вероятности на уровне игры, предоставляемые рынками ставок, дают объективные оценки с низкой дисперсией истинных вероятностей выигрышей и проигрышей в каждом профессиональном соревновании. Во-вторых, мы расширяем байесовские модели пространства состояний для парных сравнений (Glickman and Stern, 1998) для нескольких областей. Эти модели используют вероятности рынка ставок на уровне игры, чтобы отразить подразумеваемую силу и изменчивость команды. Наконец, мы представляем уникальные свойства уровня лиги, которые на данный момент было трудно уловить, и мы используем оценочные апостериорные распределения сильных сторон команды, чтобы предложить новые метрики для оценки паритета лиги, как для регулярного сезона, так и для стадии плей-офф. Мы считаем, что как из-за более узкого распределения сильных сторон команды, так и из-за меньших преимуществ домашних игр, типичное соревнование в НХЛ или MLB намного ближе к подбросу монетки, чем в НБА или НФЛ.

1.1. Обзор литературы

Важность количественной оценки силы команды в соревновании распространяется на различные дисциплины. Это включает в себя противоречивые характеристики на уровне лиги в экономике (Leeds and Von Allmen, 2004), оценку вероятностей игрового уровня в статистике (Glickman and Stern, 1998) и классификацию будущих победителей игр в прогнозировании (Boulier and Stekler, 2003). Мы обсудим и обобщим эти идеи ниже.

1.1.1. Конкурентный баланс.

Оценка конкурентного баланса спортивных лиг особенно важна в экономике и управлении (Leeds and Von Allmen, 2004). В то время как конкурентный баланс может предположительно измерять несколько различных величин, в целом это относится к уровням эквивалентности между командами. Это может быть эквивалентность в пределах одного временного интервала (например, насколько сходным было распределение талантов в течение сезона?), Между временными рамками (например, межгодовые различия в талантах) или с начала временного интервала до конца ( например, вероятность того, что каждая команда выиграет чемпионат в начале сезона).

Наиболее широко принятой мерой конкурентного баланса в течение сезона является Noll-Scully (Noll, 1991; Scully, 1989). Он рассчитывается как отношение наблюдаемого стандартного отклонения к общей победе команды к идеализированному стандартному отклонению, которое определяется как то, которое наблюдалось бы только благодаря случайности, если бы каждая команда была равной по таланту. Считается, что большие значения Нолла-Скалли отражают больший дисбаланс в сильных сторонах команды.


В то время как Noll-Scully обладает положительным качеством, позволяющим проводить сопоставимые кросс-спортивные сравнения, зависимость от выигранных проигрышей влечет за собой и нежелательные свойства (Owen, 2010; Owen and King, 2015). Например, Нолл-Скалли в среднем увеличивается с увеличением количества сыгранных игр (Оуэн и Кинг, 2015), препятствуя, например, любому сравнению НФЛ (16 игр) с MLB (162). Кроме того, каждая из лиг использует некоторую форму несбалансированного графика. Команды в каждом из MLB, НБА, НФЛ и НХЛ играют противников внутри подразделения чаще, чем противников подразделения, и противников внутри конференции чаще, чем участников межконференции, что означает, что рекорд выигрыша-поражения одной команды может быть несопоставим с результатами другой команды из-за различий в соответствующие сильные стороны их противников (Lenten, 2015). Более того, НФЛ структурирует расписание каждого сезона таким образом, чтобы команды играли в междоусобных играх с противниками, которые в предыдущем году заняли одинаковое место в турнирной таблице. В ожидании, это наказывает команды, которые заканчивают позиции в более сложных играх, потенциально увеличивая процент выигрышей до 0,500. Неудивительно, что несбалансированное планирование и игра между конференциями могут привести к неточным показателям конкурентного баланса, полученным из выигрышных процентов (Utt and Fort, 2002). Как еще одно слабое место, различные домашние преимущества между спортивными лигами, как показано в Moskowitz and Wertheim (2011), могут также повлиять на сравнение относительного качества команды, которое основано на победах и поражениях.

Хотя показатели для сравнений на уровне лиги часто обсуждаются, важность соревновательного баланса в спорте более равномерно принята, в значительной степени из-за неопределенности гипотезы исхода (Роттенберг, 1956; Ноулз, Шерони и Хауперт, 1992; Ли и Форт , 2008). Согласно этой гипотезе, успех в лиге, судя по посещаемости, вовлеченности и телевизионному доходу, положительно коррелирует с командами, имеющими равные шансы на победу. Неопределенность результатов, как правило, рассматривается на уровне игры, но может также распространяться на успех на уровне сезона (т. Е. Команды имеют равные шансы на выход в постсезонное время). В результате, в интересах каждой лиги продвигать определенный уровень паритета - короче говоря, более узкое распределение качества команды - чтобы максимизировать доход (Crooker and Fenn, 2007). В связи с этим, индекс Хирфинда Хиршмана (Owen, Ryan and Weatherston, 2007) и коэффициент конкурентного баланса (Humphreys, 2002) представляют собой две метрики, пытающиеся количественно оценить относительные шансы на успех, которые команды имеют в определенных временных рамках или между ними.

1.1.2. Подходы к оценке силы команды. Конкурентное равновесие и неопределенность исхода являются грубым показателем понимания распределения талантов между командами. Например, когда две команды с одинаковым талантом играют в игру без домашнего преимущества, неопределенность исхода максимальна; например, результат игры эквивалентен монете ﬂ ip. Эти относительные сравнения силы команды начались в статистике с парных моделей сравнения, которые обычно определяются как те, которые предназначены для калибровки эквивалентности двух объектов. В случае спорта субъектами являются команды или отдельные спортсмены.

Модель Брэдли-Терри (BTM, Брэдли и Терри (1952)) считается первой детальной парной сравнительной моделью и грубым эквивалентом вскоре разработанного рейтинга Эло (Elo, 1978; Glickman, 1995). Рассмотрим эксперимент с t уровнями лечения, сравниваемыми в парах. BTM предполагает, что существует некоторое истинное упорядочение вероятностей эффективности, π1, ..., πt, с ограничениями, которые Pt i = 1 πi = 1 и πi ≥ 0 для i = 1, ..., t. При сравнении обработки i с обработкой j вероятность того, что обработка i предпочтительнее j (т.е. выигрыш в спортивных условиях), вычисляется как πi πi + πj.

Glickman and Stern (1998) и Glickman and Stern (2016) опираются на BTM, позволяя оценкам численности команды со временем изменяться посредством моделирования дифференциальной точки в НФЛ, которая, как предполагается, следует приблизительно нормальному распределению. Пусть y (s, k) ij будет точкой дифференциала игры на неделе k сезона s между командами i и j. В этой спецификации i и j принимают значения от 1 до t, где t - количество команд в лиге. Пусть θ (s, k) i и θ (s, k) j будут сильными сторонами команды i и j, соответственно, в сезоне s в течение недели k, и пусть αi будет параметром преимущества для команды i при i = 1, ..., т. Гликман и Стерн (1998) предполагают, что для игры, сыгранной в доме команды i в течение недели k в сезоне s, E [y (s, k) ij | θ (s, k) i, θ (s, k) j, αi] = θ (s, k) i −θ (s, k) j + αi, где E [ y (s, k) ij | θ (s, k) i, θ (s, k) j, αi] - ожидаемая дифференциальная точка, учитывая сильные стороны команды i и j и преимущество команды i в домашних условиях.

Модель Glickman and Stern (1998) позволяет стохастически варьировать параметры силы команды двумя различными способами: от последней недели сезона s до первой недели сезона s + 1 и от недели k сезона s до недели k +. 1 сезона с. Как таковая, она называется моделью «пространства состояний», в соответствии с которой данные являются функцией основного изменяющегося во времени процесса плюс дополнительный шум.

Гликман и Стерн (1998) предлагают авторегрессивный процесс для моделирования сильных сторон команды, в результате чего эти параметры со временем стремятся к среднему уровню в лиге. В соответствии с этой спецификацией результаты прошлого и будущего сезонов включаются в конкретные сезонные оценки качества команды. Возможно, в результате Koopmeiners (2012) выявляет лучшие преимущества при сравнении моделей пространства состояний с возможностями BTM отдельно в каждом сезоне. Кроме того, в отличие от BTM, модели в пространстве состояний обычно не страдают от проблем с идентификацией, если команда выиграет или проиграет все свои игры за один сезон (редкая, но существующая возможность в НФЛ) .1 Для дополнительных и связанных с ними состояний. космические ресурсы, см. Fahrmeir and Tutz (1994), Knorr-Held (2000), Cattelan, Varin and Firth (2013), Baker and McHale (2015) и Manner (2015). Кроме того, Matthews (2005 г.), Owen (2011 г.), Koopmeiners (2012 г.), Tutz и Schauberger (2015 г.) и Wolfson and Koopmeiners (2015 г.) реализуют связанные версии оригинального BTM.

Хотя модель пространства состояний, обобщенная выше, кажется, хорошо работает в НФЛ, при распространении ее на другие лиги возникают некоторые проблемы. Во-первых, с точки зрения дифференциала в качестве результата на уровне игры, оценки параметров будут чувствительны к относительному количеству очков в каждом виде спорта. Таким образом, сравнение НХЛ и MLB (где игры в среднем определяются несколькими голами или забегами) с NBA и NFL (где игры в среднем определяются примерно на 10 очков) потребовало бы дальнейшего масштабирования. Во-вторых, нормальная модель цели или дифференциала забега была бы неуместна в таких видах спорта с низким счетом, как хоккей или бейсбол, где результаты забитых очков следуют процессу Пуассона (Mullet, 1977; Thomas et al., 2007). Наконец, результаты игр НХЛ повлекут за собой дополнительные осложнения, поскольку примерно 25% игр в регулярном сезоне решаются в сверхурочное время или в перестрелке.

Вместо парных моделей сравнения также были разработаны альтернативные меры для оценки силы команды. Massey (1997) использовал оценку максимального правдоподобия и результаты американского футбола для разработки одноименной рейтинговой системы. Более общая сводка других рейтинговых систем для прогнозирования использования исследована Boulier and Stekler (2003). Кроме того, машины опорных векторов и имитационные модели были предложены в хоккее (Demers, 2015; Buttrey, 2016), нейронных сетях и наивных байесах, реализованных в баскетболе (Loe e elholz et al., 2009; Miljkovi´c et al., 2010 ), линейные модели и пробит-регрессии в футболе (Harville, 1980; Boulier and Stekler, 2003) и двухэтапные байесовские модели в бейсболе (Yang and Swartz, 2004). Хотя этот список не является исчерпывающим, он говорит о глубине и разнообразии охвата, создаваемых моделями спортивного прогнозирования.

1.2. Ставки на рынке вероятностей. Во многих случаях исследователи получают оценки силы команды, чтобы предсказать вероятности на уровне игры. Информация о рынке ставок давно рекомендовалась для оценки точности этих вероятностей (Harville, 1980; Stern, 1991). Перед каждым соревнованием спортивные книги, в том числе в Лас-Вегасе и на зарубежных рынках, предоставляют цену каждой команде, более известную как денежная линия.

Математически, если денежная линия команды i равна `i против команды j (с соответствующей денежной линией` j), где | `i | ≥ 100, то вероятность выигрыша границы для этой команды, pi (`i), определяется как:
pi(`i) =( 100 100+`i if `i ≥ 100 |`i| 100+|`i| if `i ≤−100
.
Вероятность выигрыша на границе представляет собой порог, при котором ставки на команду i будут приносить прибыль в долгосрочной перспективе.

В качестве примера, предположим, что чикагским детенышам было отдано предпочтение («i = −127 на денежной линии»), чтобы побить Аризонских бриллиантов («j = 117»). Вероятность выигрыша на границе для новичков будет равна pi (−127) = 0,559; для Даймондбэков pj (117) = 0,461. Вероятности выигрыша на границе составляют больше единицы на сумму, полученную в спортивной книге как прибыль (известная в разговорной речи как «vig» или «vigorish»). Тем не менее, очень просто нормализовать граничные вероятности для суммирования с единицей, чтобы оценить pij, предполагаемую вероятность того, что я победу j:
Pij =
pi (`i) pi (` i) + pj (`j). (1)
В нашем примере деление каждой граничной вероятности на 1,02 = (0,559 + 0,461) подразумевает вероятности выигрыша 54,8% для детенышей и 45,2% для Diamondbacks.

В принципе, цены на денежные линии учитывают все детерминанты результатов игры, известные публике до игры, включая силу команды, местоположение и травмы. Исследователи определили, что во временных и спортивных лигах исследователям сложно оценить вероятности выигрыша, более точные, чем рыночные; то есть рынки ставок эффективны. В качестве неполного списка см. Harville (1980); Гандар и соавт. (1988); Лейси (1990); Стерн (1991); Карлин (1996); Colquitt, Godwin and Caudill (2001); Spann и Skiera (2009); Николс (2012); Пол и Вайнбах (2014); Лопес и Мэттьюс (2015). Интересно, что Colquitt, Godwin и Caudill (2001) предположили, что эффективность рынков баскетбола в колледже была пропорциональна количеству доступной информации перед игрой - с количеством, известным о профессиональных спортивных командах, это предполагает, что рынки в НФЛ, НБА, НХЛ и МЛБ так же эффективны, как и приходят. Маннер (2015) объединил прогнозы из модели пространства состояний с прогнозами на рынках ставок, обнаружив, что комбинация обоих прогнозов лишь иногда превосходила только рынки ставок.

Нам не известны какие-либо опубликованные результаты, в которых сравнивались лиги с использованием рыночных вероятностей. Учитывая различия в спортивных показателях оценки качества команды и ограниченные межспортивные подходы, основанные только на выигрышах и проигрышах, мы стремимся расширить парные сравнительные модели, используя информацию о денежных линиях, чтобы лучше уловить относительную командную эквивалентность в методе, который можно применять в общем.

2. Проверка правильности рыночных данных. Мы начнем с подтверждения точности рыночных данных о ставках в отношении результатов игры. Результаты игр регулярного сезона и данные линий ставок в четырех основных спортивных лигах Северной Америки (MLB, NBA, NFL и NHL) были получены за номинальную плату от Sports Insights (https://www.sportsinsights.com). Хотя эти результаты игры не являются официальными, они точны и широко используются. Наши модели соответствуют данным сезонов 2006–2016 гг., За исключением НФЛ, в котором сезон 2016 г. еще не завершен.

Эти данные были заполнены более чем на 99,3% в каждой лиге, в том смысле, что за этот период существовала действительная линия ставок для почти всех игр в этих четырех видах спорта. Линии ставок, предоставляемые Sports Insights, выражаются в виде выплат, которые мы впоследствии конвертируем в предполагаемые вероятности. Среднее значение в нашем наборе данных составляет 1,93%, но всегда является положительным, что приводит к доходу от спортивной книги за длительный период игр. В тех случаях, когда для конкретной игры было доступно более одной линии ставок, мы включали только линию, ближайшую ко времени начала игры. Сводка наших данных приведена в таблице 1.

Сводка кросс-спортивных данных. tq - количество уникальных команд в каждом виде спорта q. ngames записывает количество реальных игр, в то время как nbets записывает количество игр, для которых у нас есть линия ставок. ¯ pgames - это средняя наблюдаемая вероятность выигрыша для домашней команды, в то время как ¯ pbets - средняя подразумеваемая вероятность домашнего выигрыша на основе линии ставок. Обратите внимание, что у нас есть почти полное покрытие (коэффициенты ставок почти для каждой игры) по всем четырем основным видам спорта.

Мы также сравнили наблюдаемые вероятности домашнего выигрыша с соответствующими вероятностями, вытекающими из наших данных о рынке ставок (Рисунок 1). В каждом из четырех видов спорта тесты Хосмера-Лемешоу для гипотезы эффективного рынка с использованием 10 игровых корзин одинакового размера не показали доказательств нехватки денег при сравнении числа наблюдаемых и ожидаемых выигрышей в каждой корзине. Таким образом, мы не нашли никаких доказательств того, что вероятности, вытекающие из наших рыночных данных о ставках, являются предвзятыми или неточными - вывод, который подтверждается совокупностью академической литературы, упомянутой выше. Соответственно, мы интерпретируем эти вероятности как «истинные».

3. Байесовская модель пространства состояний. Наша модель, представленная ниже, расширяет спецификацию пространства состояний, предоставленную Гликманом и Стерном (1998), чтобы обеспечить единую основу для противопоставления четырех главных североамериканских спортивных лиг. Пусть p (q, s, k) ij - вероятность того, что команда i победит команду j в сезоне s в течение недели k спортивной лиги q для q ∈ {MLB, NBA, NFL, NHL}. Предполагается, что p (q, s, k) ij известны и рассчитываются с использованием коэффициентов спортивных ставок по уравнению (1). Используя вероятности игры, мы получаем кросс-спортивный результат, который дает больше информации, чем просто знание, какая команда выиграла игру или каков был счет. В наших обозначениях i, j = 1, ..., tq, где tq - количество команд в спорте q, таких что tMLB = tNBA = tNHL = 30 и tNFL = 32. Кроме того, s = 1, ..., Sq и k = 1, ..., Kq, где Sq и Kq - количество сезонов и недель соответственно в лиге q. По нашим данным, KNFL = 17, KNBA = 25, KMLB = KNHL = 28, с SNFL = 10 и SMLB = SNBA = SNHL = 11. Наш следующий шаг в построении модели определяет преимущество дома, и одним из непосредственных препятствий является то, что в В дополнение к наличию разного количества команд в каждой лиге, определенные франшизы могут перемещаться из одного города в другой с течением времени. В нашем наборе данных было два перемещения: из Сиэтла в Оклахома-Сити (NBA, 2008) и из Атланты в Виннипег (НХЛ, 2011). Пусть αq0 будет домашним преимуществом (HA) всей лиги в лиге q, и пусть α (q) i? быть специфическим для команды (положительным или отрицательным) для команды i среди игр, сыгранных в городе i ?, для i? = 1, ..., т? кв. Здесь, т? q - общее количество родных городов; по нашим данным, т? MLB = 30, t? NBA = t? NHL = 31, а t? NFL = 32. Обозначение θ (q, s, k) i и θ (q, s, k) j будет параметрами силы команды сезона-недели для команд i и j, соответственно, мы предполагаем, что
E[logit(p(q,s,k)ij)|θ(q,s,k)i,θ(q,s,k)j,αq0,α(q)i?] = θ(q,s,k)i −θ(q,s,k)j + αq0 + α(q)i?, 

где logit (.) - это преобразование log-odds. Обратите внимание, что θ (q, s, k) i и θ (q, s, k) j отражают абсолютные показатели силы команды и отражают вероятность того, что каждая команда обыграет среднюю команду лиги. Мы центрируем силу команды и оценки индивидуальных преимуществ дома около 0, чтобы гарантировать, что наша модель идентифицируема (например, Ptq i = 1 θ (q, s, k) i = 0 для всех q, s, k и Pt? Qi? = 1 α (q) i? = 0) Пусть p (q, s, k) представляет вектор длины g (q, s, k), количества игр в лиге q в течение недели k сезона s, содержащий все лиги q's вероятности на неделе k сезона s. Наша первая модель результатов игры, далее именуемая моделью индивидуального преимущества дома (Модель IHA), предполагает, что
logit (p (q, s, k)) ∼ N (θ (q, s, k) X (q, s, k) + αq0Jg (q, s, k) + α α αqZ (q, s, k) , σ2q, gameIg (q, s, k)), где θ (q, s, k) - вектор длины tq, содержащий параметры силы команды в сезоне s в течение недели k и α α αq = nα (q) 1, ..., α (д) т? Qo. Обратите внимание, что α α αq не меняется со временем (т.е. предполагается, что HA является постоянной для команды в течение недель и сезонов). X (q, s, k) и Z (q, s, k) содержат g (q, s, k) строк и tq и t? q столбцов соответственно. Матрица X (q, s, k) содержит значения {1,0, −1}, где для данной строки (т. Е. Одной игры) значение i-го столбца в этой строке равно 1 / -1, если i-я команда сыграла дома / в гостях в данной игре и 0 в противном случае. Z (q, s, k) - это матрица, содержащая 1 в столбце i? если соответствующая игра была сыграна в городе i ?, и 0 в противном случае. Наконец, σ2q, game - дисперсия уровня игры, Jg (q, s, k) - вектор-столбец длины g (q, s, k), содержащий все единицы, а Ig (q, s, k) - тождество. матрица с размерностью g (q, s, k) × g (q, s, k).

Кроме того, мы предлагаем упрощенную версию модели IHA, обозначенную как модель CHA (постоянное преимущество дома), в которой предполагается, что HA в каждом виде спорта идентична для каждой франшизы, так что logit (p (q, s, k)) ∼ N (θ (q, s, k) X (q, s, k) + αq0Jg (q, s, k), σ2q, gameIg (q, s, k) ). В модели CHA матрицы p (q, s, k), X (q, s, k), Jg (q, s, k) и Ig (q, s, k) определяются идентично модели IHA. В результате для игры между домашней командой i и выездной командой j в течение недели k сезона s E [logit (p (q, s, k) ij)] = θ (q, s, k) i −θ ( q, s, k) j + αq0 по модели CHA. Подобно Гликману и Стерну (1998), мы позволяем параметрам силы команд авторегрессивно изменяться от сезона к сезону и от недели к неделе. В общем, это влечет за собой то, что параметры силы команды с течением времени сокращаются до среднего уровня в лиге. Формально θ (q, s + 1,1) | θq, s, Kq, γq, сезон, σ2 q, сезон ∼ N (γq, сезонθ (q, s, Kq), σ2 q, seasonItq) для всех s ∈ 1, ..., Sq − 1 и θ (q, s, k + 1) | θ (q, s, k), γq, неделя, σ2 q, неделя ∼ N (γq, неделя θ (q, s, k), σ2 q, weekItq) для всех s ∈ 1, ..., Sq, k ∈ 1, ..., Kq −1. В этой спецификации γq, week - это авторегрессионный параметр от недели к неделе, γq, season - это авторегрессивный параметр от сезона к сезону, а Itq - единичная матрица измерения tq × tq. Учитывая изменяющуюся во времени природу нашей спецификации, все спецификации используют байесовский подход для получения модельных оценок. Для спорта q параметры силы команды для недели k = 1 и сезона s = 1 имеют предварительное распределение θ (q, 1,1) i ∼ N (0, σ2 q, сезон) для всех i ∈ 1 ,. .., TQ. Параметры преимуществ команды, характерные для команды, имеют аналогичный априор, а именно α (q) i? ∼ N (0, σ2q, α), для i ∈ 1, ..., t? кв.

Наконец, пусть τ2 q, игра = 1 / σ2 q, игра, τ2 q, сезон = 1 / σ2 q, сезон, τ2 q, неделя = 1 / σ2 q, неделя и
τ2 q, α = 1 / σ2q, α, мы предполагаем следующие предварительные распределения (Gelman et al., 2006):
τ2 q, игра ∼ Uniform (0,1000) αq0 ∼ N (0,10000) τ2 q, сезон ∼ Uniform (0,1000) γq, сезон ∼ Uniform (0,1) τ2 q, неделя ∼ Uniform (0,1000 ) γq, неделя ∼ Униформа (0,1.5) τ2 q, α ∼ Униформа (0,1000)
Обратите внимание, что мы ограничиваем γq, week и γq, сезон на 1.5 и 1.0 соответственно, что соответствует предыдущим представлениям о том, могут ли сильные стороны команды взорваться в течение (маловероятного, но выполнимого) или между (крайне маловероятными) сезонов. Один из наших главных интересов заключается в оценке эквивалентности игрового уровня команд каждой лиги; то есть насколько вероятно, что каждая команда выиграет у других команд? В этом отношении нас интересует как взгляд назад во времени (описательный), так и взгляд вперед (прогнозный). Тем не менее, модели IHA и CHA объединяют результаты за несколько недель до, во время и после недели k для оценки силы команды. Хотя это идеально подходит для измерения паритета лиги, оглядываясь назад, менее целесообразно делать прогнозы на будущие игры. Таким образом, в каждом q для сезона Sq (последний сезон наших данных) мы определяем ряд моделей пространства состояний, использующих модель IHA, которые выполняются на еженедельной основе (они называются последовательными, а не кумулятивными). Формально, для k = 2, ..., Kq в сезоне Sq, мы устанавливаем модель IHA только для игр в течение k или ранее. Последовательные значения могут использоваться, чтобы дать представление о способности прогнозирования нашей модели. Апостериорные распределения каждого параметра оцениваются с использованием методов Марковской цепи Монте-Карло (MCMC). Мы используем выборку Гиббса с помощью пакета rjags (Plummer, 2016) в статистической вычислительной среде R (R Core Team, 2016) для получения апостериорных распределений, отдельно для каждого q.2 Три цепочки - с использованием 40000 итераций после выгорания 4000 рисует, с тонким 5 - выходом 8000 задних образцов в каждом q.3 Визуальный осмотр графиков трасс с параллельными цепями используется для подтверждения сходимости. Для оценки базовых допущений моделей IHA и CHA, включая использование нами логит-преобразования для наших вероятностных результатов, мы используем апостериорные прогностические проверки распределения, как в Gelman et al. (2014). Сравнение моделей IHA и CHA проводится с использованием информационного критерия отклонения (DIC, Spiegelhalter et al. (2002)) и путем изучения апостериорного прогнозного распределения каждой модели. Хотя мы не можем делиться точными рыночными данными по ставкам из-за лицензионных ограничений, упрощенная версия наших данных на уровне игры, код обработки данных, код выборки Гиббса, апостериорные розыгрыши и код, используемый для получения апостериорных оценок и цифр, - все это размещены в репозитории GitHub, доступном по адресу https://github.com/ bigfour / Competition.